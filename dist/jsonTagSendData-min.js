function jsonTagSendData(e,t,n,i,o,r,a){function s(e){return Array.isArray(e)?e.map(s).filter((e=>!(null==e||""===e||"object"==typeof e&&0===Object.keys(e).length||"number"==typeof e&&Number.isNaN(e)))):"object"==typeof e&&null!==e?Object.fromEntries(Object.entries(e).map((([e,t])=>[e,s(t)])).filter((([,e])=>!(null==e||""===e||"object"==typeof e&&0===Object.keys(e).length||"number"==typeof e&&Number.isNaN(e))))):"number"==typeof e&&Number.isNaN(e)?void 0:e}function c(e,t){if(t){const n=t.dataLayerName,i=t.dataLayerEventName;window[n]=window[n]||[];const o={event:i},r={};if(e.device_id&&(r.device_id=e.device_id),e.session_id&&(r.session_id=e.session_id),e.tags&&(r.tags=e.tags),Object.keys(r).length>0&&(o.jsonclient=r),Object.keys(o).length>1)return o._clear=!0,window[n].push(o),!0}return!1}return(async()=>{let d=r?s(t):t;var w;d=a?((w=d).page_location=window.location.href,w.page_path=window.location.pathname,w.page_hostname=window.location.hostname,w.page_referrer=document.referrer,w.page_title=document.title,w.page_encoding=document.characterSet,w.screen_resolution=window.screen&&window.screen.width+"x"+window.screen.height,w.viewport_size=window.innerWidth&&window.innerHeight&&window.innerWidth+"x"+window.innerHeight,w.language=navigator&&navigator.language,w):d;const g=/AppleWebKit/i.test(navigator.userAgent)&&!/Chrome|OPR|Edge|SamsungBrowser|Android/i.test(navigator.userAgent);let u={"Content-Type":"application/json"};if("function"!=typeof navigator.sendBeacon&&(o="fetch"),"sendBeacon"===o)return navigator.sendBeacon(e,JSON.stringify(d)),!0;if(!g&&n&&"function"==typeof CompressionStream)try{Object.assign(u,{"Content-Encoding":"gzip"});const t=new Blob([JSON.stringify(d)],{type:"application/json"}).stream().pipeThrough(new CompressionStream("gzip")),n=new Response(t),o=await n.blob(),r=await fetch(e,{method:"POST",credentials:"include",headers:u,body:o});if(!r.ok)throw new Error("HTTP-Error! Status: "+r.status);const a=await r.json();c(a,i)}catch(e){return null}else try{const t=await fetch(e,{method:"POST",credentials:"include",headers:u,body:JSON.stringify(d)});if(!t.ok)throw new Error("HTTP-Error! Status: "+t.status);const n=await t.json();c(n,i)}catch(e){return null}})(),!0}