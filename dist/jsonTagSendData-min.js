function jsonTagSendData(e,t,n,i,o,r,a,s){function c(e){return Array.isArray(e)?e.map(c).filter((e=>!(null==e||""===e||"object"==typeof e&&0===Object.keys(e).length||"number"==typeof e&&Number.isNaN(e)))):"object"==typeof e&&null!==e?Object.fromEntries(Object.entries(e).map((([e,t])=>[e,c(t)])).filter((([,e])=>!(null==e||""===e||"object"==typeof e&&0===Object.keys(e).length||"number"==typeof e&&Number.isNaN(e))))):"number"==typeof e&&Number.isNaN(e)?void 0:e}function d(e,t){if(t){const n=t.dataLayerName,i=t.dataLayerEventName;window[n]=window[n]||[];const o={event:i},r={};if(e.device_id&&(r.device_id=e.device_id),e.session_id&&(r.session_id=e.session_id),e.tags&&(r.tags=e.tags),Object.keys(r).length>0&&(o.jsonclient=r),Object.keys(o).length>1)return o._clear=!0,window[n].push(o),!0}return!1}return(async()=>{let w=r?c(t):t;var u;w=a?((u=w).page_location=window.location.href,u.page_path=window.location.pathname,u.page_hostname=window.location.hostname,u.page_referrer=document.referrer,u.page_title=document.title,u.page_encoding=document.characterSet,u.screen_resolution=window.screen&&window.screen.width+"x"+window.screen.height,u.viewport_size=window.innerWidth&&window.innerHeight&&window.innerWidth+"x"+window.innerHeight,u.language=navigator&&navigator.language,u):w;const g=/AppleWebKit/i.test(navigator.userAgent)&&!/Chrome|OPR|Edge|SamsungBrowser|Android/i.test(navigator.userAgent);let l={"Content-Type":"application/json"};if(s&&(l["X-Gtm-Server-Preview"]=s),"function"!=typeof navigator.sendBeacon&&(o="fetch"),"sendBeacon"===o)return navigator.sendBeacon(e,JSON.stringify(w)),!0;if(!g&&n&&"function"==typeof CompressionStream)try{l["Content-Encoding"]="gzip";const t=new Blob([JSON.stringify(w)],{type:"application/json"}).stream().pipeThrough(new CompressionStream("gzip")),n=new Response(t),o=await n.blob(),r=await fetch(e,{method:"POST",credentials:"include",headers:l,body:o});if(!r.ok)throw new Error("HTTP-Error! Status: "+r.status);const a=await r.json();d(a,i)}catch(e){return null}else try{const t=await fetch(e,{method:"POST",credentials:"include",headers:l,body:JSON.stringify(w)});if(!t.ok)throw new Error("HTTP-Error! Status: "+t.status);const n=await t.json();d(n,i)}catch(e){return null}})(),!0}