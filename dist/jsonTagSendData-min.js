function jsonTagSendData(e,t,n,i,o,r){function s(e){return Array.isArray(e)?e.map(s).filter((e=>!(null==e||""===e||"object"==typeof e&&0===Object.keys(e).length||"number"==typeof e&&Number.isNaN(e)))):"object"==typeof e&&null!==e?Object.fromEntries(Object.entries(e).map((([e,t])=>[e,s(t)])).filter((([,e])=>!(null==e||""===e||"object"==typeof e&&0===Object.keys(e).length||"number"==typeof e&&Number.isNaN(e))))):"number"==typeof e&&Number.isNaN(e)?void 0:e}function a(e,t){if(t){const n=t.dataLayerName,i=t.dataLayerEventName;window[n]=window[n]||[];const o={event:i},r={};if(e.device_id&&(r.device_id=e.device_id),e.session_id&&(r.session_id=e.session_id),e.tags&&(r.tags=e.tags),Object.keys(r).length>0&&(o.jsonclient=r),Object.keys(o).length>1)return o._clear=!0,window[n].push(o),!0}return!1}return(async()=>{const c=r?s(t):t,d=/AppleWebKit/i.test(navigator.userAgent)&&!/Chrome|CriOS|OPR|Edg|Edge|FxiOS|SamsungBrowser|Android/i.test(navigator.userAgent);let u={"Content-Type":"application/json"};if("function"!=typeof navigator.sendBeacon&&(o="fetch"),"sendBeacon"===o)return navigator.sendBeacon(e,JSON.stringify(c)),!0;if(!d&&n&&"function"==typeof CompressionStream)try{Object.assign(u,{"Content-Encoding":"gzip"});const t=new Blob([JSON.stringify(c)],{type:"application/json"}).stream().pipeThrough(new CompressionStream("gzip")),n=new Response(t),o=await n.blob(),r=await fetch(e,{method:"POST",credentials:"include",headers:u,body:o});if(!r.ok)throw new Error("HTTP-Error! Status: "+r.status);const s=await r.json();a(s,i)}catch(e){return null}else try{const t=await fetch(e,{method:"POST",credentials:"include",headers:u,body:JSON.stringify(c)});if(!t.ok)throw new Error("HTTP-Error! Status: "+t.status);const n=await t.json();a(n,i)}catch(e){return null}})(),!0}